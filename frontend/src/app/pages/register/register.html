<app-navbar></app-navbar>

<div class="bg-dark text-light min-vh-100 py-5">
  <div class="container">
    <div class="row justify-content-center">
      <div class="col-md-8 col-lg-7">
        <div class="card bg-dark border-secondary">
          <div class="card-header bg-dark border-secondary text-center py-4">
            <h2 class="mb-0">Create an Account</h2>
          </div>
          <div class="card-body p-4">
            <!-- Error message -->
            <div *ngIf="errorMessage" class="alert alert-danger" role="alert">
              {{ errorMessage }}
            </div>
            
            <form (ngSubmit)="register()" #registerForm="ngForm">
              <div class="row">
                <!-- Personal Information -->
                <h5 class="mb-3">Personal Information</h5>
                
                <div class="col-md-6 mb-3">
                  <label for="firstName" class="form-label">First Name</label>
                  <input 
                    type="text" 
                    class="form-control bg-dark text-light border-secondary" 
                    id="firstName" 
                    name="firstName"
                    [(ngModel)]="user.firstName"
                    required
                    #firstNameInput="ngModel"
                    [ngClass]="{'is-invalid': firstNameInput.invalid && (firstNameInput.dirty || firstNameInput.touched)}"
                  >
                  <div *ngIf="firstNameInput.invalid && (firstNameInput.dirty || firstNameInput.touched)" class="invalid-feedback">
                    First name is required
                  </div>
                </div>
                
                <div class="col-md-6 mb-3">
                  <label for="lastName" class="form-label">Last Name</label>
                  <input 
                    type="text" 
                    class="form-control bg-dark text-light border-secondary" 
                    id="lastName" 
                    name="lastName"
                    [(ngModel)]="user.lastName"
                    required
                    #lastNameInput="ngModel"
                    [ngClass]="{'is-invalid': lastNameInput.invalid && (lastNameInput.dirty || lastNameInput.touched)}"
                  >
                  <div *ngIf="lastNameInput.invalid && (lastNameInput.dirty || lastNameInput.touched)" class="invalid-feedback">
                    Last name is required
                  </div>
                </div>
                
                <div class="col-md-6 mb-3">
                  <label for="email" class="form-label">Email address</label>
                  <input 
                    type="email" 
                    class="form-control bg-dark text-light border-secondary" 
                    id="email" 
                    name="email"
                    [(ngModel)]="user.email"
                    required
                    email
                    #emailInput="ngModel"
                    [ngClass]="{'is-invalid': emailInput.invalid && (emailInput.dirty || emailInput.touched)}"
                  >
                  <div *ngIf="emailInput.invalid && (emailInput.dirty || emailInput.touched)" class="invalid-feedback">
                    <div *ngIf="emailInput.errors?.['required']">Email is required</div>
                    <div *ngIf="emailInput.errors?.['email']">Please enter a valid email address</div>
                  </div>
                </div>
                
                <div class="col-md-6 mb-3">
                  <label for="phone" class="form-label">Phone Number</label>
                  <input 
                    type="tel" 
                    class="form-control bg-dark text-light border-secondary" 
                    id="phone" 
                    name="phone"
                    [(ngModel)]="user.phone"
                    required
                    #phoneInput="ngModel"
                    [ngClass]="{'is-invalid': phoneInput.invalid && (phoneInput.dirty || phoneInput.touched)}"
                  >
                  <div *ngIf="phoneInput.invalid && (phoneInput.dirty || phoneInput.touched)" class="invalid-feedback">
                    Phone number is required
                  </div>
                </div>
                
                <div class="col-md-6 mb-3">
                  <label for="password" class="form-label">Password</label>
                  <input 
                    type="password" 
                    class="form-control bg-dark text-light border-secondary" 
                    id="password"
                    name="password"
                    [(ngModel)]="user.password"
                    required
                    minlength="6"
                    #passwordInput="ngModel"
                    [ngClass]="{'is-invalid': (passwordInput.invalid && (passwordInput.dirty || passwordInput.touched)) || passwordMismatch}"
                  >
                  <div *ngIf="passwordInput.invalid && (passwordInput.dirty || passwordInput.touched)" class="invalid-feedback">
                    <div *ngIf="passwordInput.errors?.['required']">Password is required</div>
                    <div *ngIf="passwordInput.errors?.['minlength']">Password must be at least 6 characters long</div>
                  </div>
                </div>
                
                <div class="col-md-6 mb-3">
                  <label for="confirmPassword" class="form-label">Confirm Password</label>
                  <input 
                    type="password" 
                    class="form-control bg-dark text-light border-secondary" 
                    id="confirmPassword"
                    name="confirmPassword"
                    [(ngModel)]="user.confirmPassword"
                    required
                    #confirmPasswordInput="ngModel"
                    [ngClass]="{'is-invalid': (confirmPasswordInput.invalid && (confirmPasswordInput.dirty || confirmPasswordInput.touched)) || passwordMismatch}"
                  >
                  <div *ngIf="confirmPasswordInput.invalid && (confirmPasswordInput.dirty || confirmPasswordInput.touched)" class="invalid-feedback">
                    Please confirm your password
                  </div>
                  <div *ngIf="passwordMismatch" class="invalid-feedback">
                    Passwords do not match
                  </div>
                </div>
                
                <!-- Address Information -->
                <h5 class="mb-3 mt-2">Address Information</h5>
                
                <div class="col-md-6 mb-3">
                  <label for="country" class="form-label">Country</label>
                  <input 
                    type="text" 
                    class="form-control bg-dark text-light border-secondary" 
                    id="country" 
                    name="country"
                    [(ngModel)]="user.country"
                    required
                    #countryInput="ngModel"
                    [ngClass]="{'is-invalid': countryInput.invalid && (countryInput.dirty || countryInput.touched)}"
                  >
                  <div *ngIf="countryInput.invalid && (countryInput.dirty || countryInput.touched)" class="invalid-feedback">
                    Country is required
                  </div>
                </div>
                
                <div class="col-md-6 mb-3">
                  <label for="address" class="form-label">Address</label>
                  <input 
                    type="text" 
                    class="form-control bg-dark text-light border-secondary" 
                    id="address" 
                    name="address"
                    [(ngModel)]="user.address"
                    required
                    #addressInput="ngModel"
                    [ngClass]="{'is-invalid': addressInput.invalid && (addressInput.dirty || addressInput.touched)}"
                  >
                  <div *ngIf="addressInput.invalid && (addressInput.dirty || addressInput.touched)" class="invalid-feedback">
                    Address is required
                  </div>
                </div>
                
                <div class="col-md-4 mb-3">
                  <label for="city" class="form-label">City</label>
                  <input 
                    type="text" 
                    class="form-control bg-dark text-light border-secondary" 
                    id="city" 
                    name="city"
                    [(ngModel)]="user.city"
                    required
                    #cityInput="ngModel"
                    [ngClass]="{'is-invalid': cityInput.invalid && (cityInput.dirty || cityInput.touched)}"
                  >
                  <div *ngIf="cityInput.invalid && (cityInput.dirty || cityInput.touched)" class="invalid-feedback">
                    City is required
                  </div>
                </div>
                
                <div class="col-md-4 mb-3">
                  <label for="state" class="form-label">State/Province</label>
                  <input 
                    type="text" 
                    class="form-control bg-dark text-light border-secondary" 
                    id="state" 
                    name="state"
                    [(ngModel)]="user.state"
                    required
                    #stateInput="ngModel"
                    [ngClass]="{'is-invalid': stateInput.invalid && (stateInput.dirty || stateInput.touched)}"
                  >
                  <div *ngIf="stateInput.invalid && (stateInput.dirty || stateInput.touched)" class="invalid-feedback">
                    State/Province is required
                  </div>
                </div>
                
                <div class="col-md-4 mb-4">
                  <label for="zipCode" class="form-label">Postal Code</label>
                  <input 
                    type="text" 
                    class="form-control bg-dark text-light border-secondary" 
                    id="zipCode" 
                    name="zipCode"
                    [(ngModel)]="user.zipCode"
                    required
                    #zipCodeInput="ngModel"
                    [ngClass]="{'is-invalid': zipCodeInput.invalid && (zipCodeInput.dirty || zipCodeInput.touched)}"
                  >
                  <div *ngIf="zipCodeInput.invalid && (zipCodeInput.dirty || zipCodeInput.touched)" class="invalid-feedback">
                    Postal code is required
                  </div>
                </div>
              </div>
              
              <div class="d-grid gap-2">
                <button 
                  type="submit" 
                  class="btn btn-primary" 
                  [disabled]="registerForm.invalid || isLoading"
                >
                  <span *ngIf="isLoading" class="spinner-border spinner-border-sm me-2" role="status" aria-hidden="true"></span>
                  Create Account
                </button>
                <div class="text-center mt-3">
                  Already have an account? <a routerLink="/login" class="text-primary">Login here</a>
                </div>
              </div>
            </form>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>